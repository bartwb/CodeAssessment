===== CODE ASSESSMENT RAPPORT =====
Datum/tijd (UTC): 2025-12-02 09:41:47

== Kandidaat ==
Id      : demo-123
Naam    : Test Kandidaat
Email   : test@example.com

== Opdracht ==
AssignmentId  : csharp-junior-1
AssignmentName: Bestelbedrag met btw

== Samenvatting ==
Einds score     : 4
AI score        : 4
Compileert      : JA
Alle tests groen: NEE

== AI review ==
Score: 4 / 10

Algemene feedback:
The code has several issues related to correctness, performance, and maintainability. The use of incorrect data types for monetary calculations, lack of input validation, and absence of constants for magic numbers are significant problems. Additionally, the code lacks exception handling and proper formatting for output, which affects its robustness and readability.

Issues:
- Regels 12, Severity: Warning
  Suggestie: Consider using a constant for the VAT rate instead of a magic number. This improves readability and maintainability.
- Regels 15, Severity: Error
  Suggestie: Add a null-check for the 'lines' parameter and throw an ArgumentNullException if it is null. This ensures that the method handles invalid input gracefully.
- Regels 16, Severity: Error
  Suggestie: Use 'decimal' instead of 'double' for monetary calculations to avoid precision issues.
- Regels 20, Severity: Warning
  Suggestie: Validate that 'Quantity' is greater than 0 and 'UnitPrice' is non-negative to ensure data integrity.
- Regels 27, Severity: Warning
  Suggestie: Perform calculations using 'decimal' to maintain precision, and avoid casting between 'double' and 'decimal'.
- Regels 30, Severity: Warning
  Suggestie: Use a format string with culture information for outputting monetary values to ensure correct formatting based on locale.

== Static analysis ==
Analyzer: .NET Code Analysis (Roslyn + analyzers)
Aantal diagnostics: 22

- RCS1058 [Warning] @ 30:21
  Use compound assignment
- RCS1058 [Warning] @ 35:13
  Use compound assignment
- RCS1102 [Warning] @ 15:18
  Make class static
- RCS1123 [Warning] @ 30:39
  Add parentheses when necessary
- RCS1181 [Warning] @ 9:9
  Convert comment to documentation comment
- RCS1181 [Warning] @ 17:9
  Convert comment to documentation comment
- SA1200 [Warning] @ 2:1
  Using directive should appear within a namespace declaration
- SA1200 [Warning] @ 3:1
  Using directive should appear within a namespace declaration
- SA1400 [Warning] @ 41:21
  Element 'Main' should declare an access modifier
- SA1402 [Warning] @ 7:18
  File may only contain a single type
- SA1407 [Warning] @ 30:39
  Arithmetic expressions should declare precedence
- SA1516 [Warning] @ 11:1
  Elements should be separated by blank line
- SA1516 [Warning] @ 12:1
  Elements should be separated by blank line
- SA1517 [Warning] @ 1:1
  Code should not contain blank lines at start of file
- SA1600 [Warning] @ 11:20
  Elements should be documented
- SA1600 [Warning] @ 7:18
  Elements should be documented
- SA1600 [Warning] @ 15:18
  Elements should be documented
- SA1600 [Warning] @ 10:23
  Elements should be documented
- SA1600 [Warning] @ 12:24
  Elements should be documented
- SA1600 [Warning] @ 18:31
  Elements should be documented
- SA1633 [Warning] @ 1:1
  The file header is missing or not located at the top of the file.
- SA1649 [Warning] @ 7:18
  File name should match first type name

== Runtime ==
ExitCode         : 0
RunDurationMs    : 196
RunTotalCpuTimeMs: 62
RunAverageCpuPct : 379.6
RunPeakWorkingSet: 0 MB

Fases:
- init
  DurationMs    : 1368
  CpuTimeMs     : -
  PeakWorkingSet: -

- restore
  DurationMs    : 862
  CpuTimeMs     : -
  PeakWorkingSet: -

- build
  DurationMs    : 1716
  CpuTimeMs     : -
  PeakWorkingSet: -

- publish
  DurationMs    : 1246
  CpuTimeMs     : -
  PeakWorkingSet: -

- run
  DurationMs    : 196
  CpuTimeMs     : 62
  PeakWorkingSet: 0 MB
  Samples count : 1
  Samples range : 186 ms → 186 ms

StdOut (snippet):
  Determining projects to restore...
  All projects are up-to-date for restore.


  Determining projects to restore...
  All projects are up-to-date for restore.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-analyze-c2224aabdbb64d628b4438b3721d5798\UserApp\Program.cs(10,23): warning CS8618: Non-nullable property 'ProductName' must contain a non-null value when exiting constructor. Consider a...

== Tests ==
Binary score: FOUT
Total       : 6
Passed      : 1
Failed      : 5

Details per test:
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullList_ThrowsArgumentNullException → Failed
  Message: Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentNullException)
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeUnitPrice_ThrowsArgumentException → Failed
  Message: Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentException)
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullOrderLine_IsIgnored → Failed
  Message: System.NullReferenceException : Object reference not set to an instance of an object.
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.EmptyList_ReturnsZero → Passed
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeOrZeroQuantity_ThrowsArgumentException → Failed
  Message: Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentException)
- CodeAssessment.Tests.Template.CalculateTotalWithVatTests.MultipleLines_ComputesCorrectTotal → Failed
  Message: Assert.Equal() Failure: Values differ
Expected: 138.4240
Actual:   138.42

== dotnet test stdout ==
  Determining projects to restore...
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
  Restored C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj (in 202 ms).
  1 of 2 projects are up-to-date for restore.


  Determining projects to restore...
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
  All projects are up-to-date for restore.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\Solution.cs(10,23): warning CS8618: Non-nullable property 'ProductName' must contain a non-null value when exiting constructor. Consider adding the 'required' modifier or declaring the property as nullable. [C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\AssesmentSolution.csproj]
  AssesmentSolution -> C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\bin\Release\net10.0\AssesmentSolution.dll
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs(84,43): warning CS8632: The annotation for nullable reference types should only be used in code within a '#nullable' annotations context. [C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj]
  Tests -> C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\bin\Release\net10.0\Tests.dll

Build succeeded.

C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\Solution.cs(10,23): warning CS8618: Non-nullable property 'ProductName' must contain a non-null value when exiting constructor. Consider adding the 'required' modifier or declaring the property as nullable. [C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\AssesmentSolution.csproj]
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs(84,43): warning CS8632: The annotation for nullable reference types should only be used in code within a '#nullable' annotations context. [C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj]
    4 Warning(s)
    0 Error(s)

Time Elapsed 00:00:02.32


  Determining projects to restore...
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
  All projects are up-to-date for restore.
C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Tests.csproj : warning NU1603: Tests depends on Microsoft.NET.Test.Sdk (>= 17.10.1) but Microsoft.NET.Test.Sdk 17.10.1 was not found. Microsoft.NET.Test.Sdk 17.11.0 was resolved instead.
  AssesmentSolution -> C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\bin\Release\net10.0\AssesmentSolution.dll
  Tests -> C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\bin\Release\net10.0\Tests.dll
Test run for C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\bin\Release\net10.0\Tests.dll (.NETCoreApp,Version=v10.0)
VSTest version 18.0.1 (x64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
  Failed CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullOrderLine_IsIgnored [4 ms]
  Error Message:
   System.NullReferenceException : Object reference not set to an instance of an object.
  Stack Trace:
     at Assessment.Junior.Program.CalculateTotalWithVat(List`1 lines) in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\AssesmentSolution\Solution.cs:line 30
   at CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullOrderLine_IsIgnored() in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs:line 92
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
  Failed CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeUnitPrice_ThrowsArgumentException [1 ms]
  Error Message:
   Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentException)
  Stack Trace:
     at CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeUnitPrice_ThrowsArgumentException() in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs:line 73
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
  Failed CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullList_ThrowsArgumentNullException [< 1 ms]
  Error Message:
   Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentNullException)
  Stack Trace:
     at CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullList_ThrowsArgumentNullException() in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs:line 43
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
  Failed CodeAssessment.Tests.Template.CalculateTotalWithVatTests.MultipleLines_ComputesCorrectTotal [1 ms]
  Error Message:
   Assert.Equal() Failure: Values differ
Expected: 138.4240
Actual:   138.42
  Stack Trace:
     at CodeAssessment.Tests.Template.CalculateTotalWithVatTests.MultipleLines_ComputesCorrectTotal() in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs:line 117
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
  Failed CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeOrZeroQuantity_ThrowsArgumentException [< 1 ms]
  Error Message:
   Assert.Throws() Failure: No exception was thrown
Expected: typeof(System.ArgumentException)
  Stack Trace:
     at CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeOrZeroQuantity_ThrowsArgumentException() in C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\Test.cs:line 57
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
Results File: C:\Users\BartvandenHoven\AppData\Local\Temp\run-77eb8b23c02e4c4dacee986dec208444\Tests\TestResults\results.trx

Failed!  - Failed:     5, Passed:     1, Skipped:     0, Total:     6, Duration: 342 ms - Tests.dll (net10.0)


== dotnet test stderr ==




[xUnit.net 00:00:01.85]     CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullOrderLine_IsIgnored [FAIL]
[xUnit.net 00:00:01.85]     CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeUnitPrice_ThrowsArgumentException [FAIL]
[xUnit.net 00:00:01.85]     CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NullList_ThrowsArgumentNullException [FAIL]
[xUnit.net 00:00:01.85]     CodeAssessment.Tests.Template.CalculateTotalWithVatTests.MultipleLines_ComputesCorrectTotal [FAIL]
[xUnit.net 00:00:01.85]     CodeAssessment.Tests.Template.CalculateTotalWithVatTests.NegativeOrZeroQuantity_ThrowsArgumentException [FAIL]


== Ingezonden code ==

using System;
using System.Collections.Generic;

namespace Assessment.Junior
{
    public class OrderLine
    {
        // geen default waarde
        public string ProductName { get; set; }
        public int Quantity { get; set; }
        public decimal UnitPrice { get; set; }
    }

    public class Program
    {
        // magic number, geen const naam, geen comment
        public static decimal CalculateTotalWithVat(List<OrderLine> lines)
        {
            // geen null-check, geen ArgumentException, gewoon "doe maar wat"
            double totaal = 0; // verkeerd type voor geld

            if (lines != null)
            {
                for (int i = 0; i < lines.Count; i++)
                {
                    var l = lines[i];

                    // geen check op Quantity <= 0, geen check op negatieve prijzen
                    totaal = totaal + (double)l.UnitPrice * l.Quantity;
                }
            }

            // 21% btw "erbij", maar met double berekend en pas op het eind gecast
            totaal = totaal * 1.21;

            // random afronden op 2 decimalen via Math.Round i.c.m. double → nog meer precisie-ellende
            return (decimal)Math.Round(totaal, 2);
        }

        static void Main()
        {
            var lines = new List<OrderLine>();
            var ol1 = new OrderLine();
            ol1.ProductName = "C# in Depth";
            ol1.Quantity = 2;
            ol1.UnitPrice = 39.95m;
            lines.Add(ol1);

            var ol2 = new OrderLine();
            ol2.ProductName = "Clean Code";
            ol2.Quantity = 1;
            ol2.UnitPrice = 34.50m;
            lines.Add(ol2);

            var total = CalculateTotalWithVat(lines);

            Console.WriteLine("Totaal incl. btw: " + total); // geen format string, geen cultuur, etc.
        }
    }
}

